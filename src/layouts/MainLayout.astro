---
import { getSeoData, type Lang } from '@/utils/i18n';
import '@/styles/global.css';

interface Props {
  lang: Lang;
  title?: string;
  description?: string;
}

const { lang, title, description } = Astro.props;
const seo = getSeoData(lang);
const pageTitle = title || seo.title;
const pageDesc = description || seo.description;
const base = import.meta.env.BASE_URL || '/Curriculum_java';
---

<!doctype html>
<html lang={lang} data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={pageDesc} />
    <meta name="keywords" content={seo.keywords.join(', ')} />
    <meta name="author" content="Jesús Valdemar Benítez Castañeda" />
    <meta name="robots" content="index, follow" />
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDesc} />
    <meta property="og:locale" content={lang === 'es' ? 'es_MX' : lang === 'fr' ? 'fr_FR' : 'en_US'} />
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={pageTitle} />
    <meta name="twitter:description" content={pageDesc} />
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href={`${base}/favicon.svg`} />
    <!-- Canonical -->
    <link rel="canonical" href={`${base}/${lang}/`} />
    <link rel="alternate" hreflang="en" href={`${base}/en/`} />
    <link rel="alternate" hreflang="es" href={`${base}/es/`} />
    <link rel="alternate" hreflang="fr" href={`${base}/fr/`} />
    <title>{pageTitle}</title>
  </head>
  <body>
    <div class="noise-overlay"></div>
    <main>
      <slot />
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>© {new Date().getFullYear()} Jesús Valdemar Benítez Castañeda</p>
      </div>
    </footer>

    <!-- Scroll Reveal Observer -->
    <script>
      function initReveal() {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add('revealed');
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.1, rootMargin: '0px 0px -50px 0px' }
        );
        document.querySelectorAll('.reveal, .reveal-left, .reveal-scale')
          .forEach((el) => observer.observe(el));
      }
      document.addEventListener('DOMContentLoaded', initReveal);
      document.addEventListener('astro:page-load', initReveal);
    </script>
  </body>
</html>

<style>
  .noise-overlay {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
    opacity: 0.02;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  }
  .site-footer {
    padding: var(--space-xl) 0;
    text-align: center;
    color: var(--color-text-muted);
    font-size: 0.85rem;
    border-top: 1px solid var(--color-border);
  }
</style>
